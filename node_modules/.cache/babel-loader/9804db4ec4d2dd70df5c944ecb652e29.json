{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Nevil/festivity/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Nevil/festivity/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:/Users/Nevil/festivity/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Nevil/festivity/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Nevil/festivity/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect}from'react';import noteContext from\"../context/noteContext\";import{Link,useHistory}from'react-router-dom';import'./UserDetails.css';import axios from\"axios\";import UserDetailsItem from'./UserDetailsItem';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UserDetails=function UserDetails(props){var context=useContext(noteContext);var addInfo=context.addInfo,notes=context.notes,amount=context.amount,infos=context.infos,getInfos=context.getInfos;var _useState=useState({name:\"\",address:\"\",phoneno:\"\"}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var handleClick=function handleClick(e){e.preventDefault();addInfo(user.name,user.address,user.phoneno);};var onChange=function onChange(e){setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},e.target.name,e.target.value)));};{/*Razor Pay*/}var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),Total=_useState4[0],setTotal=_useState4[1];var history=useHistory();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),payment=_useState6[0],setpayment=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),orderId=_useState8[0],setorderId=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),paymenId=_useState10[0],setpaymenId=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),signature=_useState12[0],setsignature=_useState12[1];useEffect(function(){calculateTotal();},[]);useEffect(function(){getInfos();},[]);useEffect(function(){if(payment===true){history.push(\"/\");//   window.location.reload()\nprops.showAlert(\"Your items would be delivered to you in 3 Working days\",\"success\");}});var calculateTotal=function calculateTotal(){var total=0;notes.map(function(item){total+=parseInt(item.tag,10);});setTotal(total);};var handlebuynow=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(Total){var url,res,options,rzp1;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:url=\"http://localhost:5000/api/auth/orders/razorpay/\".concat(Total);_context.next=3;return axios.get(url);case 3:res=_context.sent;console.log(res);// console.log(Total);\noptions={\"key\":\"rzp_test_aTqnRgP2lVSkAY\",// Enter the Key ID generated from the Dashboard\n\"amount\":res.data.amount,// Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise\n\"currency\":res.data.currency,\"name\":\"FESTIVITY\",\"description\":res.data.notes,//\"image\": \"https://example.com/your_logo\",\n\"order_id\":res.data.id,//This is a sample Order ID. Pass the `id` obtained in the previous step\n\"handler\":function handler(response){// alert(response.razorpay_payment_id);\n// alert(response.razorpay_order_id);\n// alert(response.razorpay_signature)\nsetorderId(response.razorpay_order_id);setpaymenId(response.razorpay_payment_id);setsignature(response.razorpay_signature);setpayment(true);}// \"prefill\": {\n//     \"name\": \"Gaurav Kumar\",\n//     \"email\": \"gaurav.kumar@example.com\",\n//     \"contact\": \"9999999999\"\n// },\n// \"notes\": {\n//     \"address\": \"Razorpay Corporate Office\"\n// },\n// \"theme\": {\n//     \"color\": \"#3399cc\"\n// }\n};rzp1=new window.Razorpay(options);rzp1.open();rzp1.on('payment.failed',function(response){alert(response.error.code);alert(response.error.description);alert(response.error.source);alert(response.error.step);alert(response.error.reason);alert(response.error.metadata.order_id);alert(response.error.metadata.payment_id);});case 9:case\"end\":return _context.stop();}}},_callee);}));return function handlebuynow(_x){return _ref.apply(this,arguments);};}();var handleAddNewAddress=function handleAddNewAddress(){history.push(\"/address\");};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"select-header\",children:\"Select Your Address\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center payment-links mt-5\",children:[/*#__PURE__*/_jsxs(Link,{className:\"back mr-5\",\"aria-current\":\"page\",to:\"/proceedtobuy\",children:[/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-chevron-circle-left fa-sm\"}),\"Back\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-primary razorpay\",onClick:function onClick(){handlebuynow(Total);},children:[\"Complete Your Payment\\u2002\",/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-wallet\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 row my-3\",children:infos.map(function(note){return/*#__PURE__*/_jsx(UserDetailsItem,{note:note});})}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn add-address\",onClick:handleAddNewAddress,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus fa-md\"}),\"\\u2002New Address\"]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]});};export default UserDetails;","map":{"version":3,"sources":["C:/Users/Nevil/festivity/src/components/UserDetails.js"],"names":["React","useContext","useState","useEffect","noteContext","Link","useHistory","axios","UserDetailsItem","UserDetails","props","context","addInfo","notes","amount","infos","getInfos","name","address","phoneno","user","setUser","handleClick","e","preventDefault","onChange","target","value","Total","setTotal","history","payment","setpayment","orderId","setorderId","paymenId","setpaymenId","signature","setsignature","calculateTotal","push","showAlert","total","map","item","parseInt","tag","handlebuynow","url","get","res","console","log","options","data","currency","id","response","razorpay_order_id","razorpay_payment_id","razorpay_signature","rzp1","window","Razorpay","open","on","alert","error","code","description","source","step","reason","metadata","order_id","payment_id","handleAddNewAddress","note"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect } from 'react'\r\nimport noteContext from \"../context/noteContext\"\r\nimport { Link, useHistory } from 'react-router-dom'\r\nimport './UserDetails.css';\r\nimport axios from \"axios\";\r\nimport UserDetailsItem from './UserDetailsItem';\r\n\r\nconst UserDetails = (props) => {\r\n    const context = useContext(noteContext);\r\n    const { addInfo, notes, amount, infos, getInfos } = context;\r\n\r\n    const [user, setUser] = useState({ name: \"\", address: \"\", phoneno: \"\" })\r\n\r\n    const handleClick = (e) => {\r\n        e.preventDefault();\r\n        addInfo(user.name, user.address, user.phoneno);\r\n    }\r\n\r\n    const onChange = (e) => {\r\n        setUser({ ...user, [e.target.name]: e.target.value })\r\n    }\r\n\r\n    {/*Razor Pay*/ }\r\n    const [Total, setTotal] = useState(0);\r\n    let history = useHistory();\r\n\r\n    const [payment, setpayment] = useState(false)\r\n    const [orderId, setorderId] = useState('')\r\n    const [paymenId, setpaymenId] = useState('')\r\n    const [signature, setsignature] = useState('')\r\n\r\n    useEffect(() => {\r\n        calculateTotal();\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        getInfos();\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (payment === true) {\r\n            history.push(\"/\");\r\n            //   window.location.reload()\r\n            props.showAlert(\"Your items would be delivered to you in 3 Working days\", \"success\")\r\n        }\r\n    })\r\n\r\n    const calculateTotal = () => {\r\n        let total = 0;\r\n        notes.map(item => {\r\n            total += parseInt(item.tag, 10)\r\n        });\r\n        setTotal(total)\r\n    }\r\n\r\n    const handlebuynow = async (Total) => {\r\n        const url = `http://localhost:5000/api/auth/orders/razorpay/${Total}`\r\n        const res = await axios.get(url)\r\n        console.log(res)\r\n        // console.log(Total);\r\n\r\n        const options = {\r\n            \"key\": \"rzp_test_aTqnRgP2lVSkAY\", // Enter the Key ID generated from the Dashboard\r\n            \"amount\": res.data.amount, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise\r\n            \"currency\": res.data.currency,\r\n            \"name\": \"FESTIVITY\",\r\n            \"description\": res.data.notes,\r\n            //\"image\": \"https://example.com/your_logo\",\r\n            \"order_id\": res.data.id, //This is a sample Order ID. Pass the `id` obtained in the previous step\r\n            \"handler\": function (response) {\r\n                // alert(response.razorpay_payment_id);\r\n                // alert(response.razorpay_order_id);\r\n                // alert(response.razorpay_signature)\r\n                setorderId(response.razorpay_order_id);\r\n                setpaymenId(response.razorpay_payment_id);\r\n                setsignature(response.razorpay_signature);\r\n                setpayment(true);\r\n            },\r\n            // \"prefill\": {\r\n            //     \"name\": \"Gaurav Kumar\",\r\n            //     \"email\": \"gaurav.kumar@example.com\",\r\n            //     \"contact\": \"9999999999\"\r\n            // },\r\n            // \"notes\": {\r\n            //     \"address\": \"Razorpay Corporate Office\"\r\n            // },\r\n            // \"theme\": {\r\n            //     \"color\": \"#3399cc\"\r\n            // }\r\n        };\r\n        var rzp1 = new window.Razorpay(options);\r\n        rzp1.open()\r\n        rzp1.on('payment.failed', function (response) {\r\n            alert(response.error.code);\r\n            alert(response.error.description);\r\n            alert(response.error.source);\r\n            alert(response.error.step);\r\n            alert(response.error.reason);\r\n            alert(response.error.metadata.order_id);\r\n            alert(response.error.metadata.payment_id);\r\n        });\r\n\r\n    };\r\n\r\n    const handleAddNewAddress = () =>{\r\n        history.push(\"/address\")\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n        <h2 className=\"select-header\">Select Your Address</h2>\r\n        <div className=\"text-center payment-links mt-5\">\r\n                <Link className=\"back mr-5\" aria-current=\"page\" to=\"/proceedtobuy\">\r\n                    <i class=\"fas fa-chevron-circle-left fa-sm\"></i>Back\r\n                </Link>\r\n\r\n                <button className=\"btn btn-primary razorpay\" onClick={() => { handlebuynow(Total) }}>\r\n                    Complete Your Payment&ensp;<i class=\"fas fa-wallet\"></i>\r\n                </button>\r\n            </div>\r\n            <div className=\"mt-4 row my-3\">\r\n                {\r\n                    infos.map((note) => {\r\n                        return <UserDetailsItem note={note} />;\r\n                    })\r\n                }\r\n\r\n            </div>\r\n            <div className=\"container\">\r\n            <button className=\"btn add-address\" onClick={handleAddNewAddress}><i className=\"fas fa-plus fa-md\"></i>&ensp;New Address</button>\r\n            </div>\r\n\r\n            {/* <h3 className=\"user-header\">Fill-in the correct details for a flawless delivery service!</h3>\r\n            <div className=\"text-center payment-links mt-3\">\r\n                <Link className=\"back mr-5\" aria-current=\"page\" to=\"/proceedtobuy\">\r\n                    <i class=\"fas fa-chevron-circle-left fa-sm\"></i>Back\r\n                </Link>\r\n\r\n                <button className=\"btn btn-primary razorpay\" onClick={() => { handlebuynow(Total) }}>\r\n                    Purchase&ensp;<i class=\"fas fa-wallet\"></i>\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"text-center payment-links mt-3\">\r\n\r\n            </div>\r\n\r\n            <div className=\"details-content container-fluid mt-4\">\r\n                <form onsubmit=\"return validateForm()\">\r\n                    <div className=\"mb-3\">\r\n                        <i class=\"fa fa-user-circle fa-md\"></i>\r\n                        <label htmlFor=\"exampleInputEmail1\" className=\"form-label\">&ensp;Name</label>\r\n                        <input type=\"text\" className=\"form-control\" placeholder=\"Enter your full name\" id=\"name\" name=\"name\" onChange={onChange} />\r\n                    </div>\r\n                    <div className=\"mb-3\">\r\n                        <i class=\"fas fa-address-card\"></i>\r\n                        <label htmlFor=\"address\" className=\"form-label\">&ensp;Address</label>\r\n                        <textarea className=\"form-control\" placeholder=\"Enter your address\" id=\"address\" name=\"address\" onChange={onChange} />\r\n                    </div>\r\n                    <div className=\"mb-3\">\r\n                        <i class=\"fa fa-phone-alt\"></i>\r\n                        <label htmlFor=\"number\" className=\"form-label\">&ensp;Phone Number</label>\r\n                        <input type=\"number\" className=\"form-control\" placeholder=\"+91\" id=\"phoneno\" name=\"phoneno\" required onChange={onChange} />\r\n                        <div class=\"error\" id=\"numberErr\"></div>\r\n                    </div>\r\n\r\n                    <button type=\"submit\" value=\"submit\" className=\"btn btn-primary submit-details mt-3\" onClick={handleClick}>\r\n                        Add Address\r\n                    </button>\r\n\r\n                </form>\r\n\r\n            </div> */}\r\n                <br /><br /><br /><br /><br />\r\n        </>\r\n    )\r\n}\r\n\r\nexport default UserDetails"]},"metadata":{},"sourceType":"module"}